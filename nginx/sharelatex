server {
  listen 80;
  server_name sharelatex.local;

  #set $static_path /data/sharelatex/public;

  location /nginx_status {
    stub_status;
  }

  location / {
    proxy_pass http://web:3000;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
    proxy_set_header X-Forwarded-Host $host;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_read_timeout 3m;
    proxy_send_timeout 3m;
  }

  location /socket.io {
    proxy_pass http://real-time:3000;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
    proxy_set_header X-Forwarded-Host $host;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_read_timeout 3m;
    proxy_send_timeout 3m;
  }

  #location /stylesheets {
  #  expires 1y;
  #  root $static_path/;
  #}

  #location /minjs {
  #  expires 1y;
  #  root $static_path/;
  #}

  #location /img {
  #  expires 1y;
  #  root $static_path/;
  #}
}

server {
  listen 80;
  server_name docs.sharelatex.local;

  location / { proxy_pass http://docstore:3000; }
}

server {
  listen 80;
  server_name chat.sharelatex.local;

  location / { proxy_pass http://chat:3000; }
}
